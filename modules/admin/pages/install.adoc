= Установка и настройка

== Состав установочного комплекта

. Пакет установки {of-sm}: `{dv} 5 SolutionManager.msi`.
. Пакет установки расширения Службы {ws} для {of-sm}: `{dv} 5 Worker service extension for Solution manager.msi`.
// . `{dv} 5 Solution manager.exe` -- пакетный установщик модулей _{sm}_, _Служба {ws}_ и _Расширение Службы {ws} для {of-sm}_.

[#brief]
== Краткая справка по установке

.Чтобы установить {sm}, выполните следующие шаги инструкции:
. Установите модуль "Служба {ws}" при помощи инсталлятора заранее.
. Установите модули _{sm}_ и _Расширение Службы {ws} для {of-sm}_ из отдельных пакетов установки.
+
Данный вариант установки подходит для совместной и раздельной установки _{of-sm}_ и _Службы {ws}_.

[#module]
== Установка модуля "{of-sm}"

WARNING: Для установки {of-sm} нужны права локального администратора.

. Запустите пакет установки `{dv} 5 SolutionManager.msi` от имени администратора. Будет открыто приветственное окно мастера установки.
+
.Мастер установки {of-sm}
image::install-hello.png[Мастер установки {of-sm}]
+
. Примите условия лицензионного соглашения для продолжения установки и нажмите кнопку *Далее*.
+
.Условия лицензионного соглашения
image::install-license.png[Условия лицензионного соглашения]
+
. Будет показан каталог установки программы. При необходимости измените путь. Нажмите кнопку *Установить* для установки программы.
+
.Каталог установки
image::install-path.png[Каталог установки]
+
. Укажите настройки подключения к базе данных {of-sm} и адрес {of-sett-serv} и нажмите кнопку *Установить*.
+
WARNING: {sm} не требует использовать базу {dv} в качестве базы настроек для работы. рекомендуется использовать пустую БД, не применявшуюся в системе {dv}.
+
.Подключение к базе данных {of-sm}
image::install-db.png[Подключение к базе данных {of-sm}]
+
[#format]
.Формат строки подключения:
****
include::5.5.1@mgmtconsole:admin:install.adoc[tags=mssql]

include::5.5.1@mgmtconsole:admin:install.adoc[tags=pgsql]

//tag::rights[]
Пользователь, указанный в строке подключения, должен обладать правами на создание новых БД, а также полными правами на БД {of-sm}, которая будет создана при запуске xref:admin-functions.adoc#launch-sm[службы {of-sm}].

Если используется Windows-аутентификация для {mssql} Server, указанные права должны быть выданы учетной записи службы {of-sm}. Учетная запись должна быть включена в группу безопасности *Администраторы* на сервере {dv}.
//end::rights[]

Адрес {of-sett-serv} указывается в формате `\http://домен:порт`, например `\http://settings.service.com:5200`.
****
+
. Нажмите кнопку *Готово*, чтобы закрыть мастер установки.
. Перезагрузите компьютер.
+
Перезагрузка требуется для корректного завершения инициализации новой локальной группы безопасности _{dv} SolutionManager Administrators_.

[#extension]
== Установка модуля "Расширение Службы {ws} для {of-sm}"

Данный компонент должен быть установлен на компьютере с модулем "{dv} 5. Служба {ws}".

[WARNING]
====
Задачи {of-sm} должны обрабатываться только одним экземпляром Службы {ws} -- параллельная обработка заданий несколькими службами приведет к ошибке.

Если в организации установлено несколько модулей "{dv} 5. Служба {ws}", расширение для Службы {ws} следует устанавливать только на один из них.
====

NOTE: Для установки расширения нужны права локального администратора.

. Запустите пакет установки `{dv} 5 Docsvision 5 Worker service extension for Solution manager.msi`. Будет открыто приветственное окно мастера установки.
+
.Мастер установки расширения для Службы {ws}
image::install-ws-extension-hello.png[Мастер установки расширения для Службы {ws}]
+
. Примите условия лицензионного соглашения для продолжения установки и нажмите кнопку *Установить* для установки программы.
+
.Условия лицензионного соглашения
image::install-ws-extension-license.png[Условия лицензионного соглашения]
+
Расширение будет установлено в каталог установки модуля "{dv} 5. Служба {ws}".
+
. Если до установки расширения для Службы {ws} не был установлен {sm}, мастер установки потребует указать строку подключения к Менеджеру решений. Введите строку подключения к базе данных настроек {of-sm}, подключение к которой было настроено при xref:install.adoc[установке {of-sm}].
+
.Подключение к базе данных {of-sm}
image::install-ws-extension-db.png[Подключение к базе данных {of-sm}]
+
Формат строки подключения приведен <<format,выше>>.
+
Если {sm} был установлен ранее, данные будут загружены автоматически, вводить строку подключения не требуется.
+
--
include::page$install.adoc[tags=rights]
--
+
При установке расширения на компьютер с модулем _{sm}_ строка подключения будет получена из его конфигурации, страница настройки подключения -- пропущена. Требования к учетной записи, от имени которой подключается БД, сохраняются.
+
. Нажмите кнопку *Готово*, чтобы закрыть мастер установки.
. Ознакомьтесь с разделом "xref:admin-functions.adoc[]", чтобы предоставить пользователям доступ к модулю, настроить путь к временной папке, изменить подключение к базе данных {of-sm} и выполнить другие задачи.
. Ознакомьтесь с разделом "<<mgmt-console,Настройки в {of-mc}>>", чтобы выполнить необходимые для работы модуля настройки системы.

include::5.5.1@mgmtconsole:admin:install.adoc[tags=cert]

[#mgmt-console]
== Создание процесса для обработки задач {of-sm}

. После установки модуля _{sm}_ в {of-mc} автоматически появляется специальный тип конфигурации.
. В {of-mc} откройте вкладку "Служба {ws}" и подключите новый процесс. Подробнее см. "xref:5.5.1@mgmtconsole:user:worker-service.adoc[]".
+
// .Вкладка "Служба {ws}"
// image::worker-tab.png[Вкладка "Служба {ws}"]
+
. Нажмите на кнопку *Подключить процесс*.
. В появившемся окне введите _Имя процесса_ и выберите _Тип конфигурации_ *_{sm}_*.
. В настройках созданного процесса заполните обязательные поля:
+
* Таймаут -- поле необязательно для заполнения, подробнее см. в разделе "xref:5.5.1@mgmtconsole:user:worker-service.adoc#add[Добавить процесс]" документации модуля {mc}.
* Использовать x86 -- установите флаг, чтобы переключить обработку заданий на версию {of-ws} с указанной разрядностью. Когда флаг снят, используется разрядность x64.
+
WARNING: Несмотря на то, что настройки "Службы {ws}" с типом конфигурации "{sm}" создаются в {of-mc}, на страницах очереди входящих и исходящих сообщений не будут отображаться сообщения от {of-sm}. Очередь задач {of-sm} хранится в БД {of-sm}, и Служба {ws} работает с ней напрямую.
// +
// . Если в процессе выполнения запроса возникла ошибка, она будет отображена в {of-mc}, на странице "xref:5.5.1@mgmtconsole:user:msg-outgoing.adoc[Очередь исходящих сообщений]".

